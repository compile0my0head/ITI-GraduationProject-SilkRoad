<div class="auth-container">
  <div class="auth-card">
    <div class="auth-header">
      <div class="logo">
        <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
          <circle cx="24" cy="24" r="24" fill="url(#gradient2)"/>
          <path d="M14 24C14 18.477 18.477 14 24 14C29.523 14 34 18.477 34 24" stroke="white" stroke-width="3" stroke-linecap="round"/>
          <path d="M34 24C34 29.523 29.523 34 24 34C18.477 34 14 29.523 14 24" stroke="white" stroke-width="3" stroke-linecap="round" stroke-dasharray="4 4"/>
          <defs>
            <linearGradient id="gradient2" x1="0" y1="0" x2="48" y2="48">
              <stop offset="0%" stop-color="#D4AF37"/>
              <stop offset="100%" stop-color="#B8962E"/>
            </linearGradient>
          </defs>
        </svg>
      </div>
      <h1>SilkRoad</h1>
      <p class="subtitle">Create your business account</p>
    </div>

    @if (error()) {
      <div class="alert alert-error" (click)="clearError()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"/>
          <line x1="12" y1="8" x2="12" y2="12"/>
          <line x1="12" y1="16" x2="12.01" y2="16"/>
        </svg>
        <span>{{ error() }}</span>
        <button type="button" class="close-btn">Ã—</button>
      </div>
    }

    <form (ngSubmit)="onSubmit()" class="auth-form" [class.shake]="formSubmitAttempted() && !isFormValid()">
      <!-- Full Name -->
      <div class="form-group" [class.has-error]="showFullNameError()">
        <label for="fullName">
          Full Name
          <span class="required-indicator">*</span>
        </label>
        <div class="input-with-icon" [class.has-error]="showFullNameError()" [class.has-status]="fullNameTouched()">
          <span class="input-icon">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
              <circle cx="12" cy="7" r="4"/>
            </svg>
          </span>
          <input
            type="text"
            id="fullName"
            class="form-input"
            [class.input-error]="showFullNameError()"
            [class.input-success]="fullNameTouched() && fullNameValidation().valid && fullName()"
            [value]="fullName()"
            (input)="updateFullName($any($event.target).value)"
            (blur)="onFullNameBlur()"
            placeholder="Enter your full name"
            [disabled]="isLoading()"
            autocomplete="name"
          />
          @if (fullNameTouched() && fullName()) {
            <span class="status-icon" [class.success]="fullNameValidation().valid" [class.error]="!fullNameValidation().valid">
              @if (fullNameValidation().valid) {
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="20 6 9 17 4 12"/>
                </svg>
              } @else {
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"/>
                  <line x1="12" y1="8" x2="12" y2="12"/>
                  <line x1="12" y1="16" x2="12.01" y2="16"/>
                </svg>
              }
            </span>
          }
        </div>
        @if (showFullNameError()) {
          <div class="field-error">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <line x1="12" y1="8" x2="12" y2="12"/>
              <line x1="12" y1="16" x2="12.01" y2="16"/>
            </svg>
            <span>{{ fullNameValidation().message }}</span>
          </div>
        }
      </div>

      <!-- Email -->
      <div class="form-group" [class.has-error]="showEmailError()">
        <label for="email">
          Email Address
          <span class="required-indicator">*</span>
        </label>
        <div class="input-with-icon" [class.has-error]="showEmailError()" [class.has-status]="emailTouched()">
          <span class="input-icon">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
              <polyline points="22,6 12,13 2,6"/>
            </svg>
          </span>
          <input
            type="email"
            id="email"
            class="form-input"
            [class.input-error]="showEmailError()"
            [class.input-success]="emailTouched() && emailValidation().valid && email()"
            [value]="email()"
            (input)="updateEmail($any($event.target).value)"
            (blur)="onEmailBlur()"
            placeholder="Enter your email"
            [disabled]="isLoading()"
            autocomplete="email"
          />
          @if (emailTouched() && email()) {
            <span class="status-icon" [class.success]="emailValidation().valid" [class.error]="!emailValidation().valid">
              @if (emailValidation().valid) {
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="20 6 9 17 4 12"/>
                </svg>
              } @else {
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"/>
                  <line x1="12" y1="8" x2="12" y2="12"/>
                  <line x1="12" y1="16" x2="12.01" y2="16"/>
                </svg>
              }
            </span>
          }
        </div>
        @if (showEmailError()) {
          <div class="field-error">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <line x1="12" y1="8" x2="12" y2="12"/>
              <line x1="12" y1="16" x2="12.01" y2="16"/>
            </svg>
            <span>{{ emailValidation().message }}</span>
          </div>
        }
      </div>

      <!-- Password -->
      <div class="form-group" [class.has-error]="showPasswordError()">
        <label for="password">
          Password
          <span class="required-indicator">*</span>
        </label>
        <div class="input-with-icon password-field" [class.has-error]="showPasswordError()">
          <span class="input-icon">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
              <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
            </svg>
          </span>
          <input
            [type]="showPassword() ? 'text' : 'password'"
            id="password"
            class="form-input"
            [class.input-error]="showPasswordError()"
            [value]="password()"
            (input)="updatePassword($any($event.target).value)"
            (blur)="onPasswordBlur()"
            placeholder="Create a password"
            [disabled]="isLoading()"
            autocomplete="new-password"
          />
          <button 
            type="button" 
            class="password-toggle" 
            (click)="togglePasswordVisibility()"
            [attr.aria-label]="showPassword() ? 'Hide password' : 'Show password'"
          >
            @if (showPassword()) {
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
                <line x1="1" y1="1" x2="23" y2="23"/>
              </svg>
            } @else {
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                <circle cx="12" cy="12" r="3"/>
              </svg>
            }
          </button>
        </div>
        
        <!-- Password Strength Indicator -->
        @if (password()) {
          <div class="password-strength">
            <div class="strength-label">
              <span>Password strength</span>
              <span class="strength-text" [class]="passwordStrength().strength">
                @switch (passwordStrength().strength) {
                  @case ('weak') { Weak }
                  @case ('medium') { Medium }
                  @case ('strong') { Strong }
                  @case ('very-strong') { Very Strong }
                }
              </span>
            </div>
            <div class="strength-bars">
              <div class="strength-bar" [class.active]="passwordStrength().score >= 1" [class]="passwordStrength().strength"></div>
              <div class="strength-bar" [class.active]="passwordStrength().score >= 3" [class]="passwordStrength().strength"></div>
              <div class="strength-bar" [class.active]="passwordStrength().score >= 5" [class]="passwordStrength().strength"></div>
              <div class="strength-bar" [class.active]="passwordStrength().score >= 7" [class]="passwordStrength().strength"></div>
            </div>
          </div>
          
          <!-- Password Requirements -->
          <div class="password-requirements">
            <div class="req-title">Password must contain:</div>
            <ul class="req-list">
              <li [class.valid]="passwordHasLength()">
                <svg class="check-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  @if (passwordHasLength()) {
                    <polyline points="20 6 9 17 4 12"/>
                  } @else {
                    <circle cx="12" cy="12" r="10"/>
                  }
                </svg>
                At least 8 characters
              </li>
              <li [class.valid]="passwordHasUppercase()">
                <svg class="check-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  @if (passwordHasUppercase()) {
                    <polyline points="20 6 9 17 4 12"/>
                  } @else {
                    <circle cx="12" cy="12" r="10"/>
                  }
                </svg>
                One uppercase letter
              </li>
              <li [class.valid]="passwordHasLowercase()">
                <svg class="check-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  @if (passwordHasLowercase()) {
                    <polyline points="20 6 9 17 4 12"/>
                  } @else {
                    <circle cx="12" cy="12" r="10"/>
                  }
                </svg>
                One lowercase letter
              </li>
              <li [class.valid]="passwordHasNumber()">
                <svg class="check-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  @if (passwordHasNumber()) {
                    <polyline points="20 6 9 17 4 12"/>
                  } @else {
                    <circle cx="12" cy="12" r="10"/>
                  }
                </svg>
                One number
              </li>
              <li [class.valid]="passwordHasSpecial()">
                <svg class="check-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  @if (passwordHasSpecial()) {
                    <polyline points="20 6 9 17 4 12"/>
                  } @else {
                    <circle cx="12" cy="12" r="10"/>
                  }
                </svg>
                One special character (recommended)
              </li>
            </ul>
          </div>
        }
      </div>

      <!-- Confirm Password -->
      <div class="form-group" [class.has-error]="showConfirmPasswordError()">
        <label for="confirmPassword">
          Confirm Password
          <span class="required-indicator">*</span>
        </label>
        <div class="input-with-icon password-field" [class.has-error]="showConfirmPasswordError()" [class.has-status]="confirmPasswordTouched()">
          <span class="input-icon">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
              <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
              <circle cx="12" cy="16" r="1"/>
            </svg>
          </span>
          <input
            [type]="showConfirmPassword() ? 'text' : 'password'"
            id="confirmPassword"
            class="form-input"
            [class.input-error]="showConfirmPasswordError()"
            [class.input-success]="confirmPasswordTouched() && confirmPasswordValidation().valid && confirmPassword()"
            [value]="confirmPassword()"
            (input)="updateConfirmPassword($any($event.target).value)"
            (blur)="onConfirmPasswordBlur()"
            placeholder="Confirm your password"
            [disabled]="isLoading()"
            autocomplete="new-password"
          />
          @if (confirmPasswordTouched() && confirmPassword()) {
            <span class="status-icon confirm-status" [class.success]="confirmPasswordValidation().valid" [class.error]="!confirmPasswordValidation().valid">
              @if (confirmPasswordValidation().valid) {
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="20 6 9 17 4 12"/>
                </svg>
              } @else {
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"/>
                  <line x1="12" y1="8" x2="12" y2="12"/>
                  <line x1="12" y1="16" x2="12.01" y2="16"/>
                </svg>
              }
            </span>
          }
          <button 
            type="button" 
            class="password-toggle confirm-toggle" 
            (click)="toggleConfirmPasswordVisibility()"
            [attr.aria-label]="showConfirmPassword() ? 'Hide password' : 'Show password'"
          >
            @if (showConfirmPassword()) {
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
                <line x1="1" y1="1" x2="23" y2="23"/>
              </svg>
            } @else {
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                <circle cx="12" cy="12" r="3"/>
              </svg>
            }
          </button>
        </div>
        @if (showConfirmPasswordError()) {
          <div class="field-error">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <line x1="12" y1="8" x2="12" y2="12"/>
              <line x1="12" y1="16" x2="12.01" y2="16"/>
            </svg>
            <span>{{ confirmPasswordValidation().message }}</span>
          </div>
        }
      </div>

      <!-- Terms and Conditions -->
      <div class="terms-checkbox">
        <label class="custom-checkbox">
          <input 
            type="checkbox" 
            [checked]="acceptTerms()" 
            (change)="toggleTerms()"
            id="terms-checkbox"
          >
          <span class="checkmark" (click)="toggleTerms()">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
              <polyline points="20 6 9 17 4 12"/>
            </svg>
          </span>
          <span class="checkbox-label">
            I agree to the <a href="#" (click)="$event.stopPropagation(); $event.preventDefault()">Terms of Service</a> and <a href="#" (click)="$event.stopPropagation(); $event.preventDefault()">Privacy Policy</a>
          </span>
        </label>
        @if (formSubmitAttempted() && !acceptTerms()) {
          <div class="field-error">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <line x1="12" y1="8" x2="12" y2="12"/>
              <line x1="12" y1="16" x2="12.01" y2="16"/>
            </svg>
            <span>You must accept the terms to continue</span>
          </div>
        }
      </div>

      <button 
        type="submit" 
        class="btn btn-primary btn-block" 
        [disabled]="isLoading()"
        [class.btn-loading]="isLoading()"
      >
        @if (isLoading()) {
          <span class="spinner"></span>
          Creating account...
        } @else {
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
            <circle cx="8.5" cy="7" r="4"/>
            <line x1="20" y1="8" x2="20" y2="14"/>
            <line x1="23" y1="11" x2="17" y2="11"/>
          </svg>
          Create Account
        }
      </button>
    </form>

    <div class="auth-footer">
      <p>Already have an account? <a routerLink="/auth/login">Sign in</a></p>
    </div>
  </div>
</div>
