<div class="platforms-page">
  <!-- Header -->
  <div class="page-header">
    <div class="header-content">
      <h1>Platform Connections</h1>
      <p class="subtitle">Connect your social media accounts to publish content directly from SilkRoad</p>
    </div>
  </div>

  <!-- Error Alert -->
  @if (error()) {
    <div class="alert alert-error">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"/>
        <line x1="15" y1="9" x2="9" y2="15"/>
        <line x1="9" y1="9" x2="15" y2="15"/>
      </svg>
      <span>{{ error() }}</span>
    </div>
  }

  <!-- Loading State -->
  @if (isLoading()) {
    <div class="loading-container">
      <div class="spinner"></div>
      <p>Loading platforms...</p>
    </div>
  } @else {
    <!-- Available Platforms -->
    <section class="platforms-section">
      <h2 class="section-title">Available Platforms</h2>
      <div class="platforms-grid">
        @for (platform of availablePlatforms(); track platform.value) {
          <div class="platform-card" [class.connected]="isConnected(platform.name)">
            <div class="platform-icon" [style.background-color]="getPlatformColor(platform.name)">
              <span class="icon-emoji">{{ getPlatformIcon(platform.name) }}</span>
            </div>
            <div class="platform-info">
              <h3>{{ platform.displayName }}</h3>
              @if (isConnected(platform.name)) {
                <div class="connected-info">
                  <span class="status-badge connected">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <polyline points="20,6 9,17 4,12"/>
                    </svg>
                    Connected
                  </span>
                  @if (getConnectedPlatform(platform.name); as connected) {
                    <p class="page-name">{{ connected.pageName }}</p>
                    <p class="connected-date">Since {{ formatDate(connected.createdAt) }}</p>
                  }
                </div>
              } @else {
                @if (platform.isOAuthEnabled) {
                  <p class="oauth-status">OAuth Available</p>
                } @else {
                  <p class="oauth-status coming-soon">Coming Soon</p>
                }
              }
            </div>
            <div class="platform-actions">
              @if (isConnected(platform.name)) {
                @if (getConnectedPlatform(platform.name); as connected) {
                  <button class="btn-disconnect" (click)="disconnectPlatform(connected)">
                    Disconnect
                  </button>
                }
              } @else {
                @if (platform.isOAuthEnabled) {
                  <button class="btn-connect" [routerLink]="['connect', platform.name.toLowerCase()]">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
                      <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
                    </svg>
                    Connect
                  </button>
                } @else {
                  <button class="btn-connect disabled" disabled>
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <circle cx="12" cy="12" r="10"/>
                      <line x1="12" y1="8" x2="12" y2="12"/>
                      <line x1="12" y1="16" x2="12.01" y2="16"/>
                    </svg>
                    Coming Soon
                  </button>
                }
              }
            </div>
          </div>
        } @empty {
          <div class="empty-state">
            <p>No platforms available</p>
          </div>
        }
      </div>
    </section>

    <!-- Connected Platforms Summary -->
    @if (platforms().length > 0) {
      <section class="connected-section">
        <h2 class="section-title">Your Connected Accounts</h2>
        <div class="connected-list">
          @for (platform of platforms(); track platform.id) {
            <div class="connected-item">
              <div class="platform-icon small" [style.background-color]="getPlatformColor(platform.platformName)">
                <span class="icon-emoji">{{ getPlatformIcon(platform.platformName) }}</span>
              </div>
              <div class="item-info">
                <h4>{{ platform.platformName }}</h4>
                <p>{{ platform.pageName || 'Page connected' }}</p>
              </div>
              <div class="item-status">
                @if (platform.isConnected) {
                  <span class="status-badge active">Active</span>
                } @else {
                  <span class="status-badge inactive">Inactive</span>
                }
              </div>
              <div class="item-actions">
                <button class="btn-icon" title="Disconnect" (click)="disconnectPlatform(platform)">
                  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 6L6 18M6 6l12 12"/>
                  </svg>
                </button>
              </div>
            </div>
          }
        </div>
      </section>
    }

    <!-- Help Section -->
    <section class="help-section">
      <div class="help-card">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"/>
          <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
          <line x1="12" y1="17" x2="12.01" y2="17"/>
        </svg>
        <div class="help-content">
          <h3>Need Help?</h3>
          <p>Connecting your social accounts allows you to publish campaign content directly from SilkRoad. Currently, only Facebook is available. More platforms coming soon!</p>
        </div>
      </div>
    </section>
  }
</div>
