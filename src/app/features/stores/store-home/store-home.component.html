<div class="home-container">
  <!-- Header -->
  <header class="home-header">
    <div class="header-brand" (click)="goToLanding()" style="cursor: pointer;">
      <svg width="40" height="40" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
        <rect width="48" height="48" rx="12" fill="#0B0F19"/>
        <path d="M14 32L24 16L34 32H14Z" fill="#D4AF37"/>
      </svg>
      <span class="brand-name">SilkRoad</span>
    </div>
    <div class="header-user">
      @if (user()) {
        <span class="user-name">{{ user()!.fullName }}</span>
      }
      <button class="btn btn-ghost" (click)="logout()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"/>
          <polyline points="16 17 21 12 16 7"/>
          <line x1="21" y1="12" x2="9" y2="12"/>
        </svg>
        Logout
      </button>
    </div>
  </header>

  <!-- Main Content -->
  <main class="home-main">
    <!-- Error Alert -->
    @if (error()) {
      <div class="alert alert-error" (click)="clearError()">
        <span>{{ error() }}</span>
        <button class="close-btn">&times;</button>
      </div>
    }

    <!-- Welcome Section -->
    <div class="welcome-section">
      <h1>Welcome to SilkRoad</h1>
      <p>Select a store to manage or create a new one</p>
    </div>

    <!-- Loading State -->
    @if (isLoading()) {
      <div class="loading-container">
        <div class="spinner-large"></div>
        <p>Loading your stores...</p>
      </div>
    } @else {
      <!-- Empty State -->
      @if (!hasStores()) {
        <div class="empty-state">
          <div class="empty-icon">
            <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"/>
              <polyline points="9 22 9 12 15 12 15 22"/>
            </svg>
          </div>
          <h2>No Stores Yet</h2>
          <p>Create your first store to start managing products, orders, and campaigns.</p>
          <button class="btn btn-primary btn-lg" (click)="openCreateModal()">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="12" y1="5" x2="12" y2="19"/>
              <line x1="5" y1="12" x2="19" y2="12"/>
            </svg>
            Create Your First Store
          </button>
        </div>
      } @else {
        <!-- Stores Grid -->
        <div class="stores-section">
          <div class="section-header">
            <h2>Your Stores</h2>
            <button class="btn btn-primary" (click)="openCreateModal()">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="5" x2="12" y2="19"/>
                <line x1="5" y1="12" x2="19" y2="12"/>
              </svg>
              New Store
            </button>
          </div>

          <div class="stores-grid">
            @for (store of stores(); track store.id) {
              <div class="store-card" (click)="selectStore(store)">
                <div class="store-logo">
                  <div class="logo-placeholder">
                    {{ store.storeName.charAt(0).toUpperCase() }}
                  </div>
                </div>
                <div class="store-info">
                  <h3>{{ store.storeName }}</h3>
                  @if (store.storeDescription) {
                    <p>{{ store.storeDescription }}</p>
                  }
                </div>
                <div class="store-arrow">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="9 18 15 12 9 6"/>
                  </svg>
                </div>
              </div>
            }
          </div>
        </div>

        <!-- Teams Section (Placeholder) -->
        <div class="teams-section">
          <div class="section-header">
            <h2>Your Teams</h2>
            <span class="badge badge-coming-soon" title="Teams feature coming soon">Coming Soon</span>
          </div>
          <div class="teams-placeholder">
            <div class="placeholder-icon">
              <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/>
                <circle cx="9" cy="7" r="4"/>
                <path d="M23 21v-2a4 4 0 00-3-3.87"/>
                <path d="M16 3.13a4 4 0 010 7.75"/>
              </svg>
            </div>
            <p>Team collaboration features are coming soon!</p>
          </div>
        </div>
      }
    }
  </main>
</div>

<!-- Create Store Modal -->
@if (showCreateModal()) {
  <div class="modal-overlay" (click)="closeCreateModal()">
    <div class="modal" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>Create New Store</h2>
        <button class="close-btn" (click)="closeCreateModal()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="form-group" [class.has-error]="showStoreNameError()">
          <label for="storeName">
            Store Name
            <span class="required-indicator">*</span>
          </label>
          <div class="input-wrapper" [class.has-error]="showStoreNameError()">
            <input
              type="text"
              id="storeName"
              class="form-input"
              [class.input-error]="showStoreNameError()"
              [class.input-success]="storeNameTouched() && storeNameValidation().valid && newStoreName()"
              [value]="newStoreName()"
              (input)="newStoreName.set($any($event.target).value)"
              (blur)="onStoreNameBlur()"
              placeholder="Enter store name"
            />
            @if (storeNameTouched() && newStoreName()) {
              <span class="status-icon" [class.success]="storeNameValidation().valid" [class.error]="!storeNameValidation().valid">
                @if (storeNameValidation().valid) {
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="20 6 9 17 4 12"/>
                  </svg>
                } @else {
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <line x1="12" y1="8" x2="12" y2="12"/>
                    <line x1="12" y1="16" x2="12.01" y2="16"/>
                  </svg>
                }
              </span>
            }
          </div>
          @if (showStoreNameError()) {
            <div class="field-error">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <line x1="12" y1="8" x2="12" y2="12"/>
                <line x1="12" y1="16" x2="12.01" y2="16"/>
              </svg>
              <span>{{ storeNameValidation().message }}</span>
            </div>
          } @else {
            <span class="form-hint">Minimum 3 characters</span>
          }
        </div>
        <div class="form-group">
          <label for="storeDescription">Description</label>
          <textarea
            id="storeDescription"
            class="form-input"
            [value]="newStoreDescription()"
            (input)="newStoreDescription.set($any($event.target).value)"
            placeholder="Brief description of your store"
            rows="3"
          ></textarea>
          <span class="form-hint">Optional - Add a brief description</span>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="closeCreateModal()">Cancel</button>
        <button 
          class="btn btn-primary" 
          (click)="createStore()"
          [disabled]="isLoading()"
          [class.btn-loading]="isLoading()"
        >
          @if (isLoading()) {
            <span class="spinner"></span>
            Creating...
          } @else {
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="12" y1="5" x2="12" y2="19"/>
              <line x1="5" y1="12" x2="19" y2="12"/>
            </svg>
            Create Store
          }
        </button>
      </div>
    </div>
  </div>
}
